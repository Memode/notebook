(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{663:function(e,t,a){e.exports=a.p+"static/media/edit-icon.509ac59a.svg"},664:function(e,t,a){e.exports=a.p+"static/media/filter-icon.e4479bae.svg"},665:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l,n=a(1),r=(l=n)&&l.__esModule?l:{default:l},s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var l=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,a):{};l.get||l.set?Object.defineProperty(t,a,l):t[a]=e[a]}return t.default=e,t}(a(629));function i(e){return(i="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var a=0;a<t.length;a++){var l=t[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(e,l.key,l)}}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}a(717),a(718),a(719),a(680);var d=function(e){function t(e){var a,l,n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),l=this,(a=!(n=c(t).call(this,e))||"object"!==i(n)&&"function"!==typeof n?p(l):n).setPieOption=a.setPieOption.bind(p(p(a))),a.state={lastColor:"#E4E4E4",usedColor:"#8198FC",warnColor:"#FE5826"},a}var a,l,n;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,r.default.Component),a=t,(l=[{key:"componentDidMount",value:function(){var e=[{type:"used",name:"\u5df2\u4f7f\u7528"},{type:"total",name:"\u5269\u4f59\u5bb9\u91cf"}],t=this.props.pieData,a=t?[Object.assign(e[0],t[0]),Object.assign(e[1],t[1])]:e,l=s.init(this.refs.container),n=this.setPieOption(a,this.state.lastColor,this.state.usedColor,this.state.warnColor,this.props.title);l.setOption(n)}},{key:"setPieOption",value:function(e,t,a,l,n){return{title:{text:n,left:"center",top:"center",textStyle:{color:"#333",fontSize:14,align:"center",fontFamily:"PingFangSC-Medium"}},series:[{name:"\u6bd4\u4f8b",type:"pie",stillShowZeroSum:!1,radius:["50%","75%"],avoidLabelOverlap:!1,data:e,itemStyle:{normal:{color:function(e){return e.percent>80&&"used"===e.data.type?l:"used"===e.data.type?a:"total"===e.data.type?t:void 0}}},label:{normal:{show:!1},emphasis:{show:!1}},labelLine:{normal:{show:!1}}}]}}},{key:"render",value:function(){return r.default.createElement("div",{className:"pie-container-wrapper"},r.default.createElement("div",{ref:"container",style:{width:"".concat(this.props.pw?this.props.pw:"150","px"),height:"".concat(this.props.ph?this.props.ph:"150","px")}}))}}])&&o(a.prototype,l),n&&o(a,n),t}();t.default=d},680:function(e,t,a){},840:function(e,t,a){"use strict";var l;Object.defineProperty(t,"__esModule",{value:!0});var n=y(a(1)),r=y(a(665)),s=y(a(664)),i=y(a(663)),o=a(109),c=a(83),u=a(264),p=a(265),d=a(85),f=a(266),m=a(110);a(841);var h=y(a(267));function y(e){return e&&e.__esModule?e:{default:e}}function E(e){return(E="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e,t){for(var a=0;a<t.length;a++){var l=t[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(e,l.key,l)}}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function S(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var C=(0,h.default)({loader:function(){return a.e(18).then(a.t.bind(null,636,7))},loading:function(){return null}}),w=(0,h.default)({loader:function(){return a.e(19).then(a.t.bind(null,850,7))},loading:function(){return null}}),N=(0,h.default)({loader:function(){return a.e(20).then(a.t.bind(null,851,7))},loading:function(){return null}}),P=(0,h.default)({loader:function(){return a.e(21).then(a.t.bind(null,852,7))},loading:function(){return null}}),O=(0,h.default)({loader:function(){return a.e(22).then(a.t.bind(null,853,7))},loading:function(){return null}}),k=(0,h.default)({loader:function(){return a.e(23).then(a.t.bind(null,854,7))},loading:function(){return null}}),D=(0,h.default)({loader:function(){return a.e(0).then(a.t.bind(null,645,7))},loading:function(){return null}}),_=n.default.createElement("div",null),M=n.default.createElement("img",{className:"ml4",src:i.default,alt:""}),A=n.default.createElement(o.Select.Option,{key:111,value:0},"\u6240\u6709\u90e8\u95e8"),Q=n.default.createElement(o.Button,null,n.default.createElement("img",{className:"icon",src:s.default,alt:""}),"\u7b5b\u9009"),j=n.default.createElement(o.Icon,{type:"search"}),L=n.default.createElement("img",{className:"ml4",src:i.default,alt:""}),U=n.default.createElement("h3",{className:"title"},"\u90e8\u95e8\u5bb9\u91cf\u4f7f\u7528\u8be6\u60c5"),T=n.default.createElement(D,null),I=n.default.createElement(w,null),x=n.default.createElement(N,null),R=n.default.createElement(k,null),H=n.default.createElement(P,null),G=n.default.createElement(O,null),B=(0,c.connect)(function(e){return{loginUser:e.userReducer,selectedStaffList:e.staffReducer.selectedStaffList,activePerson:e.staffReducer.activePerson,employeese:e.staffReducer.staffData,enterpriseTotal:e.staffReducer.enterpriseTotal,deptData:e.deptReducer,capaModalState:e.capaReducer,sumaryCapacity:e.capaReducer.sumaryCapacity,employeeModalState:e.employeeModalReducer}},{getStaffList:u.getStaffList,getDeptList:p.getDeptList,toggleCapaModalState:f.toggleCapaModalState,selectDeptfn:f.selectDeptfn,searchAll:f.searchAll,toggleModalState:m.toggleModalState})(l=function(e){function t(e){var a,l,n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),l=this,(a=!(n=b(t).call(this,e))||"object"!==E(n)&&"function"!==typeof n?S(l):n).state={escale:1,dscale:1,tscale:1,isAllocation:"",page:1,limit:30,searchName:"",deptId:0},a.filterEm=a.filterEm.bind(S(S(a))),a.handleSelectChange=a.handleSelectChange.bind(S(S(a))),a.searchHandler=a.searchHandler.bind(S(S(a))),a.emitEmptySearchName=a.emitEmptySearchName.bind(S(S(a))),a.updateLibsCapa=a.updateLibsCapa.bind(S(S(a))),a.updateEmployeeCapa=a.updateEmployeeCapa.bind(S(S(a))),a.updateOneCapa=a.updateOneCapa.bind(S(S(a))),a.updateDeptCapa=a.updateDeptCapa.bind(S(S(a))),a.setEveryEmpCapa=a.setEveryEmpCapa.bind(S(S(a))),a.staffDetail=a.staffDetail.bind(S(S(a))),a}var a,l,s;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}(t,n.default.Component),a=t,(l=[{key:"componentWillMount",value:function(){var e=window.screen.availHeight;e>900?(this.setState({escale:.95}),this.setState({dscale:.88}),this.setState({tscale:.58})):e<900&&e>800?(this.setState({escale:.88}),this.setState({dscale:.85}),this.setState({tscale:.45})):e<800&&e>700&&(this.setState({escale:.7}),this.setState({dscale:.85}),this.setState({tscale:.45})),this.props.searchAll(),this.getEmployees()}},{key:"filterEm",value:function(e){this.setState({isAllocation:e}),this.getEmployees({isAllocation:e})}},{key:"handleSelectChange",value:function(e){this.setState({deptId:e}),this.getEmployees({deptId:e})}},{key:"getEmployees",value:function(e){var t={isAllocation:this.state.isAllocation,page:this.state.page,limit:this.state.limit,searchName:this.state.searchName,deptId:this.state.deptId},a=e?Object.assign(t,e):t;this.props.getStaffList(a)}},{key:"searchHandler",value:function(){""!==this.state.searchName.trim()&&this.getEmployees()}},{key:"emitEmptySearchName",value:function(){this.setState({searchName:""}),this.getEmployees({searchName:""})}},{key:"componentWillReceiveProps",value:function(e){""===e.loginUser.userRole||e.deptData.deptList||e.getDeptList({type:e.loginUser.userRole})}},{key:"componentDidUpdate",value:function(){}},{key:"staffDetail",value:function(e){e.target.className.indexOf("sd-class")>-1&&this.props.toggleModalState("STAFF_DETAIL",!0)}},{key:"updateLibsCapa",value:function(){this.props.toggleCapaModalState("UPDATE_LIBS_CAPA",!0)}},{key:"updateEmployeeCapa",value:function(){this.props.toggleCapaModalState("SET_EMP_CAPA",!0)}},{key:"updateOneCapa",value:function(){this.props.toggleCapaModalState("SET_ONE_CAPA",!0)}},{key:"updateDeptCapa",value:function(e){this.props.selectDeptfn(e),this.props.toggleCapaModalState("UPDATE_DEPT_CAPA",!0)}},{key:"setEveryEmpCapa",value:function(){this.props.toggleCapaModalState("SET_EVERY_CAPA",!0)}},{key:"render",value:function(){var e=this,t=n.default.createElement("div",{className:"cp filter-items"},n.default.createElement("div",{className:""===this.state.isAllocation?"active":"",onClick:function(){return e.filterEm("")}},"\u5168\u90e8\u5458\u5de5"),n.default.createElement("div",{className:"1"===this.state.isAllocation?"active":"",onClick:function(){return e.filterEm("1")}},"\u5df2\u5206\u914d"),n.default.createElement("div",{className:"-1"===this.state.isAllocation?"active":"",onClick:function(){return e.filterEm("-1")}},"\u5f85\u5206\u914d")),a=[{title:"\u5458\u5de5",dataIndex:"name",render:function(e){return n.default.createElement("div",{className:"cp"},e)}},{title:"\u6240\u5728\u90e8\u95e8",dataIndex:"dept"},{title:"\u5bb9\u91cf",dataIndex:"capa"}],l=0!==this.props.employeese.length?this.props.employeese.object.map(function(t){var a=t.departments.length>0?t.departments.map(function(e,t){return t>0?"\u3001"+e.name:e.name}):"\u672a\u5206\u914d\u90e8\u95e8";return{key:t.userId,name:n.default.createElement("div",{className:"tr-content sd-class",onClick:e.staffDetail},n.default.createElement("div",null,n.default.createElement(o.Avatar,{src:(0,d.getAvatar)(t.cloudUserId)}),n.default.createElement("span",{className:"ml8"},t.name)),_),dept:n.default.createElement("div",{className:"ellipsis cp sd-class",onClick:e.staffDetail,title:a},a),capa:n.default.createElement("div",{onClick:e.updateOneCapa,className:"cp"},"\u5df2\u7528",t.spaceUsed,"/\u5171",t.spaceTotal,"G",M)}}):[],s=this.props,i=s.deptData,c=s.sumaryCapacity;return n.default.createElement("div",null,n.default.createElement("div",{className:"total-toolbar"},c?n.default.createElement("div",{className:"total"},n.default.createElement("div",{className:"icon-wrapper"},n.default.createElement(r.default,{pw:60,ph:60,title:"",pieData:[{value:c.enterpriseQuota-c.residuePicQuota},{value:c.residuePicQuota}]})),n.default.createElement("div",{className:"name-count"},n.default.createElement("h4",{className:"name"},this.props.loginUser.enterpriseName,"\uff08\u5171",this.props.enterpriseTotal,"\u4eba\uff09"),n.default.createElement("div",{className:"count"},"\u5df2\u4f7f\u7528",c.enterpriseQuota-c.residuePicQuota,"G/\u5171",c.enterpriseQuota,"G"))):null,n.default.createElement("div",{className:"toolbar"},n.default.createElement(o.Select,{className:"mr6",defaultValue:"\u6240\u6709\u90e8\u95e8",style:{width:220},onChange:this.handleSelectChange},A,i.deptList&&i.deptList.length>0?i.deptList.map(function(e,t){return n.default.createElement(o.Select.Option,{key:t,value:e.departmentId},e.name)}):null),n.default.createElement(o.Popover,{className:"mr6",placement:"bottom",content:t},Q),n.default.createElement(o.Input,{prefix:j,placeholder:"\u8bf7\u8f93\u5165\u5173\u952e\u5b57\u67e5\u8be2",suffix:this.state.searchName?n.default.createElement(o.Icon,{type:"close-circle",onClick:this.emitEmptySearchName}):null,onChange:function(t){return e.setState({searchName:t.target.value})},value:this.state.searchName,onPressEnter:this.searchHandler}),n.default.createElement(o.Button,{onClick:this.searchHandler},"\u67e5\u8be2"))),n.default.createElement("div",{className:"content-wrapper"},n.default.createElement("div",{className:"sum-staff"},c?n.default.createElement("div",{className:"sum-wrapper"},n.default.createElement("div",{className:"pie-wrapper"},n.default.createElement(r.default,{pw:150*this.state.escale,ph:150*this.state.escale,title:"\u5269\u4f59\u5bb9\u91cf",pieData:[{value:c.enterpriseQuota-c.residuePicQuota},{value:c.residuePicQuota}]}),n.default.createElement("div",{className:"desc cp"},"\u5269\u4f59",c.residueQuota,"/\u5171",c.enterpriseQuota,"G")),n.default.createElement("div",{className:"pie-wrapper"},n.default.createElement(r.default,{pw:150*this.state.escale,ph:150*this.state.escale,title:"\u4f01\u4e1a\u6587\u5e93",pieData:[{value:c.libraryPicUsedQuota},{value:c.libraryQuota-c.libraryPicUsedQuota}]}),n.default.createElement("div",{onClick:this.updateLibsCapa,className:"desc cp"},"\u5df2\u4f7f\u7528",c.libraryUsedQuota,"/\u5171",c.libraryQuota,"G",L)),n.default.createElement("div",{className:"pie-wrapper"},n.default.createElement(r.default,{pw:150*this.state.escale,ph:150*this.state.escale,title:"\u5458\u5de5\u5bb9\u91cf",pieData:[{value:c.personalPicUsedQuota},{value:c.personalQuota-c.personalPicUsedQuota}]}),n.default.createElement("div",{className:"desc"},"\u5df2\u4f7f\u7528",c.personalUsedQuota,"/\u5171",c.personalQuota,"G")),n.default.createElement("div",{className:"pie-wrapper"},n.default.createElement(r.default,{pw:150*this.state.escale,ph:150*this.state.escale,title:"\u90e8\u95e8\u5bb9\u91cf",pieData:[{value:c.departmentPicUsedQuota},{value:c.departmentQuota-c.departmentPicUsedQuota}]}),n.default.createElement("div",{className:"desc"},"\u5df2\u4f7f\u7528",c.departmentUsedQuota,"/\u5171",c.departmentQuota,"G"))):null,n.default.createElement("div",{className:"staff-wrapper"},n.default.createElement("div",{className:"datagrid-wrapper capa-emp"},n.default.createElement(C,{customHeader:function(){return n.default.createElement("div",{className:"batch-wrapper"},e.props.selectedStaffList.length>0?n.default.createElement(o.Button,{onClick:e.updateEmployeeCapa,size:"small"},"\u4fee\u6539\u5bb9\u91cf"):n.default.createElement(o.Button,{onClick:e.setEveryEmpCapa,size:"small"},"\u4fee\u6539\u4eba\u5747\u5bb9\u91cf"))},tableSize:this.state.escale<.9?"small":"defalut",calSelect:!0,tscale:this.state.tscale,tableHead:a,sourceData:l})),this.props.employeese.total>0?n.default.createElement("div",{className:"pagenation-wrapper"},n.default.createElement(o.Pagination,{defaultCurrent:this.props.employeese.currentPage,total:this.props.employeese.total,showTotal:function(){return(0,d.paginationTotal)(e.props.employeese.total,e.props.employeese.currentPage)},onChange:this.pageChange})):null)),n.default.createElement("div",{className:"dept-sum"},U,n.default.createElement("div",{className:"depts-wrapper",style:{maxHeight:"".concat(76*this.state.dscale,"vh")}},i.deptList?i.deptList.map(function(t){return n.default.createElement("div",{key:t.departmentId,className:"dept-item"},n.default.createElement("div",{className:"total"},n.default.createElement("div",{className:"icon-wrapper"},n.default.createElement(r.default,{pw:60,ph:60,title:"",pieData:[{value:t.departmentPicSpaceUsed},{value:t.departmentSpaceTotal-t.departmentPicSpaceUsed}]})),n.default.createElement("div",{className:"name-count"},n.default.createElement("h4",{className:"name"},t.name,"(\u5171",t.subEmployees,"\u4eba)"),n.default.createElement("div",{className:"count"},"\u5df2\u4f7f\u7528",t.departmentSpaceUsed,"/\u5171",t.departmentSpaceTotal,"G"))),n.default.createElement(o.Button,{onClick:function(){return e.updateDeptCapa(t)},type:"primary",size:"small"},"\u4fee\u6539"))}):null))),this.props.employeeModalState.staffDetailModalVisible?T:null,this.props.capaModalState.updateLibsCapaModalShow?I:null,this.props.capaModalState.updateDeptCapaModalShow?x:null,this.props.capaModalState.setEveryCapaModalShow?R:null,this.props.capaModalState.setEmpCapaModalShow?H:null,this.props.capaModalState.setOneCapaModalShow?G:null)}}])&&v(a.prototype,l),s&&v(a,s),t}())||l;t.default=B},841:function(e,t,a){}}]);
//# sourceMappingURL=10.38c3a43b.chunk.js.map
{"version":3,"sources":["components/modals/sdmmodal.js"],"names":["__webpack_require__","_antd","_reactRedux","_employeeModalReducer","_staffReducer","SDMModal","connect","state","loginUser","userReducer","activePerson","staffReducer","currentDept","deptReducer","toggleModalState","getStaffList","props","_this","_classCallCheck","this","_getPrototypeOf","call","pointUserId","isAllocation","page","limit","searchName","deptId","handleOk","bind","_assertThisInitialized","handleCancel","setManager","React","Component","console","log","params","bool","removeManager","_this2","userId","pointType","departmentId","http","put","then","res","status","Modal","success","title","centered","content","getEmployees","_this3","delete","_react2","default","createElement","width","visible","onCancel","footer","Button","key","onClick","type"],"mappings":"kJACA,QAAAA,EAAA,IACAC,EAAAD,EAAA,KACAE,EAAAF,EAAA,QACAA,EAAA,KACAG,EAAAH,EAAA,KACAI,EAAAJ,EAAA,kyBAWMK,GAVL,EAAAH,EAAAI,SACG,SAAAC,GACI,MAAM,CACFC,UAAUD,EAAME,YAChBC,aAAaH,EAAMI,aAAaD,aAChCE,YAAYL,EAAMM,YAAYD,cAGtC,CAACE,oCAAiBC,4CAGlB,SAAAV,EAAYW,GAAM,IAAAC,MAAA,mGAAAC,CAAAC,KAAAd,KACdc,MAAAF,MAAAG,EAAAf,GAAAgB,KAAAF,KAAMH,oDACDT,MAAM,CACPe,YAAY,GAEZC,aAAa,GACbC,KAAK,EACLC,MAAM,GACNC,WAAW,GACXC,OAAO,IAEXV,EAAKW,SAASX,EAAKW,SAASC,KAAdC,IAAAb,KACdA,EAAKc,aAAad,EAAKc,aAAaF,KAAlBC,IAAAb,KAClBA,EAAKe,WAAWf,EAAKe,WAAWH,KAAhBC,IAAAb,KAbFA,yPADCgB,UAAMC,6DAiBrBC,QAAQC,IAAIjB,KAAKH,4CAGRW,GACT,IAAIU,EAAO,CACPd,aAAaJ,KAAKZ,MAAMgB,aACxBC,KAAKL,KAAKZ,MAAMiB,KAChBC,MAAMN,KAAKZ,MAAMkB,MACjBC,WAAWP,KAAKZ,MAAMmB,WAEtBC,OAAOA,GAEXR,KAAKH,MAAMD,aAAasB,sCAGrBlB,KAAKH,MAAMsB,KACVnB,KAAKa,aAELb,KAAKoB,qDAGD,IAAAC,EAAArB,KACJkB,EAAO,CACPf,YAAYH,KAAKH,MAAMN,aAAa+B,OAEpCC,UAAU,IACVf,OAAOR,KAAKH,MAAMJ,YAAY+B,cAElCC,UAAKC,IAAI,8BAA8BR,GAAQS,KAAK,SAAAC,GAC7CA,GAAoB,MAAbA,EAAIC,SACVC,QAAMC,QAAQ,CACVC,MAAO,2BACPC,UAAS,EACTC,QAAS,8BAEbb,EAAKxB,MAAMF,iBAAiB,WAAU,GAEtC0B,EAAKc,aAAad,EAAKxB,MAAMJ,YAAY+B,yDAItC,IAAAY,EAAApC,KACXyB,UAAKY,OAAO,0BAA0B,CAACrC,KAAKH,MAAMN,aAAa+B,OAAO,IAAItB,KAAKH,MAAMJ,YAAY+B,eAAeG,KAAK,SAAAC,GAC9GA,GAAoB,MAAbA,EAAIC,SACVC,QAAMC,QAAQ,CACVC,MAAO,2BACPC,UAAS,EACTC,QAAS,8BAEbE,EAAKvC,MAAMF,iBAAiB,WAAU,GAEtCyC,EAAKD,aAAaC,EAAKvC,MAAMJ,YAAY+B,wDAKlDxB,KAAKH,MAAMF,iBAAiB,WAAU,oCAGrC,OACI2C,EAAAC,QAAAC,cAAC1D,EAAAgD,MAAD,CACIW,MAAO,IACPC,SAAS,EACTV,MAAOhC,KAAKH,MAAMsB,KAAK,6CAAU,6CAAWc,UAAQ,EACpDU,SAAU3C,KAAKY,aACfgC,OAAQ,CACJN,EAAAC,QAAAC,cAAC1D,EAAA+D,OAAD,CAAQC,IAAI,IAAKC,QAAS/C,KAAKY,cAA/B,gBACA0B,EAAAC,QAAAC,cAAC1D,EAAA+D,OAAD,CAASC,IAAI,IAAIE,KAAK,UAAWD,QAAS/C,KAAKS,UAA/C,kBAPR,iGAgBGvB","file":"static/js/16.7989b0ee.chunk.js","sourcesContent":["//设置部门管理员\r\nimport React from 'react'\r\nimport {Modal,Button} from 'antd'\r\nimport {connect} from 'react-redux'\r\nimport http from 'libs/http'\r\nimport {toggleModalState} from 'store/employeeModalReducer'\r\nimport {getStaffList} from 'store/staffReducer'\r\n@connect(\r\n    state=>{\r\n        return{\r\n            loginUser:state.userReducer,\r\n            activePerson:state.staffReducer.activePerson,\r\n            currentDept:state.deptReducer.currentDept\r\n        }\r\n    },\r\n    {toggleModalState,getStaffList}\r\n)\r\nclass SDMModal extends React.Component{\r\n    constructor(props){\r\n        super(props)\r\n        this.state={\r\n            pointUserId:'',\r\n            //请求相关参数\r\n            isAllocation:'',//已分配未分配\r\n            page:1,\r\n            limit:30,\r\n            searchName:'',\r\n            deptId:'',\r\n        }\r\n        this.handleOk=this.handleOk.bind(this)\r\n        this.handleCancel=this.handleCancel.bind(this)\r\n        this.setManager=this.setManager.bind(this)\r\n    }\r\n    componentDidMount(){\r\n        console.log(this.props)\r\n    }\r\n    //获取员工列表\r\n    getEmployees(deptId){\r\n        let params={\r\n            isAllocation:this.state.isAllocation,\r\n            page:this.state.page,\r\n            limit:this.state.limit,\r\n            searchName:this.state.searchName,\r\n            //当前部门ID\r\n            deptId:deptId\r\n        }\r\n        this.props.getStaffList(params)\r\n    }\r\n    handleOk(){\r\n        if(this.props.bool){\r\n            this.setManager()\r\n        }else{\r\n            this.removeManager()\r\n        }\r\n    }\r\n    setManager(){\r\n        let params={\r\n            pointUserId:this.props.activePerson.userId,\r\n            //（0.：企业管理员1.：部门主管2.：部门管理员）\r\n            pointType:'2',\r\n            deptId:this.props.currentDept.departmentId\r\n        }\r\n        http.put('enterprise/admin/setManager',params).then(res=>{\r\n            if(res && res.status===200){\r\n                Modal.success({\r\n                    title: '系统提示',\r\n                    centered:true,\r\n                    content: '操作成功!',\r\n                })\r\n                this.props.toggleModalState('DEFAULT',false)\r\n                //指定完成之后刷新当前页面\r\n                this.getEmployees(this.props.currentDept.departmentId)\r\n            }\r\n        })\r\n    }\r\n    removeManager(){\r\n        http.delete('enterprise/admin/delete',[this.props.activePerson.userId,'2',this.props.currentDept.departmentId]).then(res=>{\r\n            if(res && res.status===200){\r\n                Modal.success({\r\n                    title: '系统提示',\r\n                    centered:true,\r\n                    content: '操作成功!',\r\n                })\r\n                this.props.toggleModalState('DEFAULT',false)\r\n                //指定完成之后刷新当前页面\r\n                this.getEmployees(this.props.currentDept.departmentId)\r\n            }\r\n        })\r\n    }\r\n    handleCancel(){\r\n       this.props.toggleModalState('DEFAULT',false)\r\n    }\r\n    render(){\r\n        return (\r\n            <Modal\r\n                width={300}\r\n                visible={true}\r\n                title={this.props.bool?\"指定部门管理员\":\"移除部门管理员\"} centered\r\n                onCancel={this.handleCancel}\r\n                footer={[\r\n                    <Button key='1'  onClick={this.handleCancel}>取消</Button>,\r\n                    <Button  key='2' type=\"primary\"  onClick={this.handleOk}>确认</Button>,\r\n                ]}\r\n                >\r\n                确定要操作吗？\r\n            </Modal>\r\n        )\r\n    }\r\n}\r\n\r\nexport default SDMModal"],"sourceRoot":""}
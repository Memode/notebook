{"version":3,"sources":["components/modals/dsmodal.js"],"names":["__webpack_require__","_antd","_reactRedux","_employeeModalReducer","_staffReducer","_deptReducer","CDModal","connect","state","selectedStaffList","staffReducer","currentDept","deptReducer","activePerson","loginUser","userReducer","toggleModalState","getStaffList","getDeptList","props","_this","_classCallCheck","this","_getPrototypeOf","call","handleOk","bind","_assertThisInitialized","handleCancel","React","Component","userRole","deleteStaff","userId","departmentId","deptId","_this2","http","delete","then","res","status","Modal","success","title","centered","content","getEmployees","id","type","obj","p","isAllocation","page","limit","searchName","params","Object","assign","_react2","default","createElement","width","visible","onCancel","footer","Button","key","onClick"],"mappings":"iJACA,QAAAA,EAAA,IACAC,EAAAD,EAAA,KACAE,EAAAF,EAAA,QACAA,EAAA,KACAG,EAAAH,EAAA,KACAI,EAAAJ,EAAA,KACAK,EAAAL,EAAA,kyBAYMM,GAXL,EAAAJ,EAAAK,SACG,SAAAC,GACI,MAAM,CACFC,kBAAkBD,EAAME,aAAaD,kBACrCE,YAAYH,EAAMI,YAAYD,YAC9BE,aAAaL,EAAME,aAAaG,aAChCC,UAAUN,EAAMO,cAGxB,CAACC,oCAAiBC,4BAAaC,0CAG/B,SAAAZ,EAAYa,GAAM,IAAAC,MAAA,mGAAAC,CAAAC,KAAAhB,KACdgB,MAAAF,MAAAG,EAAAjB,GAAAkB,KAAAF,KAAMH,oDACDM,SAASL,EAAKK,SAASC,KAAdC,IAAAP,KACdA,EAAKQ,aAAaR,EAAKQ,aAAaF,KAAlBC,IAAAP,KAHJA,yPADAS,UAAMC,oDAMd,IACDhB,EAAaQ,KAAKH,MAAlBL,UAEmB,eAArBA,EAAUiB,SACTT,KAAKU,YAAYV,KAAKH,MAAMN,aAAaoB,OAAOX,KAAKH,MAAMR,YAAYuB,cAC7C,eAArBpB,EAAUiB,UAEfT,KAAKU,YAAYV,KAAKH,MAAMN,aAAaoB,OAAO,uCAI5CA,EAAOE,GAAO,IAAAC,EAAAd,KACtBe,UAAKC,OAAO,6BAA6B,CAACL,EAAOE,IAASI,KAAK,SAAAC,GACxDA,GAAoB,MAAbA,EAAIC,SACVC,QAAMC,QAAQ,CACVC,MAAO,2BACPC,UAAS,EACTC,QAAS,8BAEbV,EAAKjB,MAAMH,iBAAiB,WAAU,GAC1B,IAATmB,GAECC,EAAKW,aAAa,CAACZ,OAAOC,EAAKjB,MAAMR,YAAYuB,eAE9CD,IAASG,EAAKjB,MAAML,UAAUkC,IAC7BZ,EAAKjB,MAAMD,YAAY,CAAC+B,KAAKb,EAAKjB,MAAML,UAAUiB,YAExC,IAATI,GAELC,EAAKW,uDAMRG,GACT,IAAIC,EAAE,CACFC,aAAa,GACbC,KAAK,EACLC,MAAM,GACNC,WAAW,GAEXpB,OAAO,GAEPqB,EAAON,EAAIO,OAAOC,OAAOP,EAAED,GAAKC,EACpC7B,KAAKH,MAAMF,aAAauC,wFAMzBlC,KAAKH,MAAMH,iBAAiB,WAAU,oCAGrC,OACI2C,EAAAC,QAAAC,cAAC5D,EAAAyC,MAAD,CACIoB,MAAO,IACPC,SAAS,EACTnB,MAAM,2BAAOC,UAAQ,EACrBmB,SAAU1C,KAAKM,aACfqC,OAAQ,CACJN,EAAAC,QAAAC,cAAC5D,EAAAiE,OAAD,CAAQC,IAAI,IAAKC,QAAS9C,KAAKM,cAA/B,gBACA+B,EAAAC,QAAAC,cAAC5D,EAAAiE,OAAD,CAASC,IAAI,IAAIlB,KAAK,UAAWmB,QAAS9C,KAAKG,UAA/C,kBAPR,4FAgBGnB","file":"static/js/1.ab39b85b.chunk.js","sourcesContent":["//删除员工(删除只能删除单个员工)\r\nimport React from 'react'\r\nimport {Modal,Button} from 'antd'\r\nimport {connect} from 'react-redux'\r\nimport http from 'libs/http'\r\nimport {toggleModalState} from 'store/employeeModalReducer'\r\nimport {getStaffList} from 'store/staffReducer'\r\nimport {getDeptList} from 'store/deptReducer'\r\n@connect(\r\n    state=>{\r\n        return{\r\n            selectedStaffList:state.staffReducer.selectedStaffList,\r\n            currentDept:state.deptReducer.currentDept,\r\n            activePerson:state.staffReducer.activePerson,\r\n            loginUser:state.userReducer\r\n        }\r\n    },\r\n    {toggleModalState,getStaffList,getDeptList}\r\n)\r\nclass CDModal extends React.Component{\r\n    constructor(props){\r\n        super(props)\r\n        this.handleOk=this.handleOk.bind(this)\r\n        this.handleCancel=this.handleCancel.bind(this)\r\n    }\r\n    handleOk(){\r\n        let {loginUser} = this.props\r\n        //（部门管理员）在部门中删除员工\r\n        if(loginUser.userRole==='department'){\r\n            this.deleteStaff(this.props.activePerson.userId,this.props.currentDept.departmentId)\r\n        }else if(loginUser.userRole==='enterprise'){\r\n            //(企业管理者)人员管理删除员工\r\n            this.deleteStaff(this.props.activePerson.userId,0)\r\n        }\r\n        \r\n    }\r\n    deleteStaff(userId,deptId){\r\n        http.delete('enterprise/delete/employee',[userId,deptId]).then(res=>{\r\n            if(res && res.status===200){\r\n                Modal.success({\r\n                    title: '系统提示',\r\n                    centered:true,\r\n                    content: '删除成功!',\r\n                })\r\n                this.props.toggleModalState('DEFAULT',false)\r\n                if(deptId!==0){\r\n                    //部门内部删除员工\r\n                    this.getEmployees({deptId:this.props.currentDept.departmentId})\r\n                    //主管自己把自己删了（重新获取部门列表）,部门主管不是部门里面的人，怎么把自己删除的\r\n                    if(userId===this.props.loginUser.id){\r\n                        this.props.getDeptList({type:this.props.loginUser.userRole})\r\n                    }\r\n                }else if(deptId===0){\r\n                    //人员管理删除员工\r\n                    this.getEmployees()\r\n                }\r\n            }\r\n        })\r\n    }\r\n    //获取员工列表\r\n    getEmployees(obj){\r\n        let p={\r\n            isAllocation:'',\r\n            page:1,\r\n            limit:30,\r\n            searchName:'',\r\n            //当前部门ID\r\n            deptId:0\r\n        }\r\n        let params=obj?Object.assign(p,obj):p\r\n        this.props.getStaffList(params)\r\n    }\r\n    componentDidUpdate(){\r\n        \r\n    }\r\n    handleCancel(){\r\n       this.props.toggleModalState('DEFAULT',false)\r\n    }\r\n    render(){\r\n        return (\r\n            <Modal\r\n                width={300}\r\n                visible={true}\r\n                title=\"删除员工\" centered\r\n                onCancel={this.handleCancel}\r\n                footer={[\r\n                    <Button key='1'  onClick={this.handleCancel}>取消</Button>,\r\n                    <Button  key='2' type=\"primary\"  onClick={this.handleOk}>确认</Button>,\r\n                ]}\r\n                >\r\n                确定要删除吗?\r\n            </Modal>\r\n        )\r\n    }\r\n}\r\n\r\nexport default CDModal"],"sourceRoot":""}
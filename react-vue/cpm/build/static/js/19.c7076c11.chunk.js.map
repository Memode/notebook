{"version":3,"sources":["components/capamodals/ulcmodal.js"],"names":["__webpack_require__","_antd","_reactRedux","_capaReducer","ULCModal","connect","state","sumaryCapacity","capaReducer","toggleCapaModalState","searchAll","props","_this","_classCallCheck","this","_getPrototypeOf","call","defaultValue","min","max","handleCancel","bind","_assertThisInitialized","handleOk","onChange","React","Component","params","id","libraryClouldUserId","type","modifyType","spaceQuota","batchUpdate","_this2","http","put","then","res","data","code","Modal","success","title","centered","content","setState","msg","Math","floor","residuePicQuota","libraryQuota","libraryPicUsedQuota","val","_react2","default","createElement","width","visible","autoFocus","onCancel","footer","Button","key","onClick","InputNumber","style","size","color","fontSize"],"mappings":"kJACA,QAAAA,EAAA,IACAC,EAAAD,EAAA,KACAE,EAAAF,EAAA,QACAA,EAAA,KACAG,EAAAH,EAAA,kyBASMI,GARL,EAAAF,EAAAG,SACG,SAAAC,GACI,MAAM,CACFC,eAAeD,EAAME,YAAYD,iBAGzC,CAACE,4CAAqBC,sCAGtB,SAAAN,EAAYO,GAAM,IAAAC,MAAA,mGAAAC,CAAAC,KAAAV,KACdU,MAAAF,MAAAG,EAAAX,GAAAY,KAAAF,KAAMH,oDACDL,MAAM,CACPW,aAAa,EACbC,IAAI,EACJC,IAAI,GAERP,EAAKQ,aAAaR,EAAKQ,aAAaC,KAAlBC,IAAAV,KAClBA,EAAKW,SAASX,EAAKW,SAASF,KAAdC,IAAAV,KACdA,EAAKY,SAASZ,EAAKY,SAASH,KAAdC,IAAAV,KATAA,yPADCa,UAAMC,oDAYf,IAEFC,EADCpB,EAAkBO,KAAKH,MAAvBJ,eAIDoB,EAFDb,KAAKR,MAAMW,aAAa,EAEhB,CAAC,CAACW,GAAGrB,EAAesB,oBAAoBC,KAAK,EAAEC,WAAW,IAAIC,WAAWlB,KAAKR,MAAMW,eAGnF,CAAC,CAACW,GAAGrB,EAAesB,oBAAoBC,KAAK,EAAEC,WAAW,IAAIC,YAAYlB,KAAKR,MAAMW,eAEjGH,KAAKmB,YAAYN,uCAETA,GAAO,IAAAO,EAAApB,KACfqB,UAAKC,IAAI,iCAAiCT,GAAQU,KAAK,SAAAC,GAChC,MAAhBA,EAAIC,KAAKC,MACRC,QAAMC,QAAQ,CACVC,MAAO,2BACPC,UAAS,EACTC,QAAS,8BAGbX,EAAKvB,MAAMD,YACXwB,EAAKvB,MAAMF,qBAAqB,oBAAmB,GAEnDyB,EAAKY,SAAS,CAAC7B,aAAa,KAE5BwB,QAAMC,QAAQ,CACVC,MAAO,2BACPC,UAAS,EACTC,QAASP,EAAIC,KAAKQ,+CAM9BjC,KAAKH,MAAMF,qBAAqB,oBAAmB,+CAEpC,IACVF,EAAkBO,KAAKH,MAAvBJ,eACLO,KAAKgC,SAAS,CAEV3B,IAAI6B,KAAKC,MAAM1C,EAAe2C,iBAE9BhC,IAAI8B,KAAKC,MAAM1C,EAAe4C,aAAa5C,EAAe6C,sEAM9DtC,KAAKgC,SAAS,CACV3B,IAAI,EACJD,IAAI,qCAIHmC,GACLvC,KAAKgC,SAAS,CACV7B,aAAaoC,qCAIjB,OACIC,EAAAC,QAAAC,cAACvD,EAAAwC,MAAD,CACIgB,MAAO,IACPC,SAAS,EACTC,WAAW,EACXhB,MAAM,wEAAiBC,UAAQ,EAC/BgB,SAAU9C,KAAKM,aACfyC,OAAQ,CACJP,EAAAC,QAAAC,cAACvD,EAAA6D,OAAD,CAAQC,IAAI,IAAKC,QAASlD,KAAKM,cAA/B,gBACAkC,EAAAC,QAAAC,cAACvD,EAAA6D,OAAD,CAASC,IAAI,IAAIjC,KAAK,UAAWkC,QAASlD,KAAKS,UAA/C,kBAGJ+B,EAAAC,QAAAC,cAAA,WACIF,EAAAC,QAAAC,cAACvD,EAAAgE,YAAD,CAAaC,MAAO,CAACT,MAAM,SAAUE,WAAS,EAACQ,KAAK,QACpDjD,KAAMJ,KAAKR,MAAMY,IAAKC,IAAKL,KAAKR,MAAMa,IAAKF,aAAcH,KAAKR,MAAMW,aAAcO,SAAUV,KAAKU,YAErG8B,EAAAC,QAAAC,cAAA,OAAKU,MAAO,CAACE,MAAM,UAAUC,SAAS,SAAtC,4OAMDjE","file":"static/js/19.c7076c11.chunk.js","sourcesContent":["//修改企业文库容量（update library）\r\nimport React from 'react'\r\nimport {Modal,Button,InputNumber} from 'antd'\r\nimport {connect} from 'react-redux'\r\nimport http from 'libs/http'\r\nimport {toggleCapaModalState,searchAll} from 'store/capaReducer'\r\n@connect(\r\n    state=>{\r\n        return{\r\n            sumaryCapacity:state.capaReducer.sumaryCapacity,\r\n        }\r\n    },\r\n    {toggleCapaModalState,searchAll}\r\n)\r\nclass ULCModal extends React.Component{\r\n    constructor(props){\r\n        super(props)\r\n        this.state={\r\n            defaultValue:1,\r\n            min:0,\r\n            max:0\r\n        }\r\n        this.handleCancel=this.handleCancel.bind(this)\r\n        this.handleOk=this.handleOk.bind(this)\r\n        this.onChange=this.onChange.bind(this)\r\n    }\r\n    handleOk(){\r\n        let {sumaryCapacity} = this.props\r\n        let params\r\n        if(this.state.defaultValue>0){\r\n            //增加容量,modifyType修改类型（人员p，部门d，文库l）\r\n            params=[{id:sumaryCapacity.libraryClouldUserId,type:1,modifyType:'l',spaceQuota:this.state.defaultValue}]\r\n        }else{\r\n            //减少容量\r\n            params= [{id:sumaryCapacity.libraryClouldUserId,type:0,modifyType:'l',spaceQuota:-this.state.defaultValue}]\r\n        }\r\n        this.batchUpdate(params)\r\n    }\r\n    batchUpdate(params){\r\n        http.put('enterprise/spaceQu/batchUpdate',params).then(res=>{\r\n            if(res.data.code===200){\r\n                Modal.success({\r\n                    title: '系统提示',\r\n                    centered:true,\r\n                    content: '操作成功!',\r\n                })\r\n                //请求成功，刷新部门容量、容量使用概述、员工容量列表\r\n                this.props.searchAll()\r\n                this.props.toggleCapaModalState('UPDATE_LIBS_CAPA',false)\r\n                //操作之后刷新数据（操作selectedRowKeys）\r\n                this.setState({defaultValue:1})\r\n            }else{\r\n                Modal.success({\r\n                    title: '系统提示',\r\n                    centered:true,\r\n                    content: res.data.msg,\r\n                })\r\n            }\r\n        })\r\n    }\r\n    handleCancel(){\r\n        this.props.toggleCapaModalState('UPDATE_LIBS_CAPA',false)\r\n    }\r\n    componentDidMount(){\r\n        let {sumaryCapacity} = this.props\r\n        this.setState({\r\n            //最大不能超过企业剩余容量\r\n            max:Math.floor(sumaryCapacity.residuePicQuota),\r\n            //最小不能小于企业文库剩余容量\r\n            min:Math.floor(sumaryCapacity.libraryQuota-sumaryCapacity.libraryPicUsedQuota),\r\n            //defaultValue:sumaryCapacity.libraryQuota\r\n        })\r\n    }\r\n    //Can't perform a React state update on an unmounted component. This is a no-op, but it indicates a memory leak in your application\r\n    componentWillUnmount(){\r\n        this.setState({\r\n            max:0,\r\n            min:0\r\n        })\r\n    }\r\n    //修改的容量\r\n    onChange(val){\r\n        this.setState({\r\n            defaultValue:val\r\n        })\r\n    }\r\n    render(){\r\n        return(\r\n            <Modal\r\n                width={350}\r\n                visible={true}\r\n                autoFocus={true}\r\n                title=\"修改企业文库容量(单位：G)\" centered\r\n                onCancel={this.handleCancel}\r\n                footer={[\r\n                    <Button key='1'  onClick={this.handleCancel}>取消</Button>,\r\n                    <Button  key='2' type=\"primary\"  onClick={this.handleOk}>保存</Button>,\r\n                ]}\r\n                >\r\n                <div>\r\n                    <InputNumber style={{width:'200px'}} autoFocus size='large' \r\n                    min={-this.state.min} max={this.state.max} defaultValue={this.state.defaultValue} onChange={this.onChange} />\r\n                </div>\r\n                <div style={{color:'#666666',fontSize:'14px',}}>修改的容量是在已有容量的基础上增加或减少且不能低于已用的容量</div>\r\n            </Modal>\r\n        )\r\n    }\r\n}\r\n\r\nexport default ULCModal"],"sourceRoot":""}
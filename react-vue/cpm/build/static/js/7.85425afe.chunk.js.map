{"version":3,"sources":["components/datagrid/datagrid.js","static/images/empty-icon.svg","static/images/dept-icon-person.svg","static/images/edit-icon.svg","container/employee/employee.js"],"names":["__webpack_require__","_antd","_reactRedux","_staffReducer","_react2","default","createElement","alt","src","emptyIcon","Datagrid","connect","state","employeese","staffReducer","staffData","object","selectedStaffList","togglePersonal","selectedStaff","React","Component","np","_this","this","emptyStyle","height","concat","props","tscale","display","alignItems","justifyContent","empty","style","_ref","rowSelection","selectedRowKeys","length","map","ss","key","onChange","selectRowKeys","selectRows","onSelect","record","selected","selectedRows","onSelectAll","isSlectedAll","changeRows","Table","calSelect","columns","tableHead","onRow","onClick","ap","filter","e","userId","onMouseEnter","size","tableSize","title","customHeader","locale","emptyText","pagination","rowClassName","className","dataSource","sourceData","scroll","y","module","exports","p","_common","_employeeModalReducer","_deptReducer","Personal","_reactLoadable2","loader","then","t","bind","loading","DDModal","DSModal","SDDModal","UDNModal","ADDSModal","deptIconPerson","editIcon","Icon","type","Employee","loginUser","userReducer","employeeModalState","employeeModalReducer","currentDept","deptReducer","deptList","toggleModalState","getStaffList","setCurrentDept","_classCallCheck","_getPrototypeOf","call","page","limit","searchName","deptId","getEmployees","_assertThisInitialized","deleteDept","setManager","staffDetail","delStaff","updatedn","searchHandler","emitEmptySearchName","addStaff","ah","window","screen","availHeight","console","log","setState","scale","departmentId","ns","tp","userRole","obj","trim","params","Object","assign","target","indexOf","subEmployees","Modal","confirm","centered","content","okText","cancelText","onOk","onCancel","_this2","popoverContent","_ref2","_ref3","tHead","dataIndex","render","text","pageData","employee","dmbool","bmbool","departments","d","i","name","userRoleInfos","some","u","roleName","Avatar","getAvatar","cloudUserId","_ref4","_ref5","Popover","placement","fontSize","dept","phone","mobile","email","_ref6","_ref7","Button","Input","prefix","_ref8","placeholder","suffix","value","onPressEnter","_datagrid2","total","Pagination","defaultCurrent","currentPage","showTotal","paginationTotal","pageChange","deleteDeptModalVisible","_ref9","staffDetailModalVisible","_ref10","addStaffModalVisible","_ref11","delStaffModalVisible","_ref12","setDeptManagerModalVisible","_ref13","updateDeptNameModalVisible","_ref14"],"mappings":"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","file":"static/js/7.85425afe.chunk.js","sourcesContent":["import React from 'react'\r\nimport {Table} from 'antd'\r\nimport {connect} from 'react-redux'\r\nimport {togglePersonal,selectedStaff} from 'store/staffReducer'\r\nimport emptyIcon from 'static/images/empty-icon.svg'\r\nimport './datagrid.scss'\r\n@connect(\r\n    state=>{\r\n        return{\r\n            employeese:state.staffReducer.staffData.object,\r\n            selectedStaffList:state.staffReducer.selectedStaffList\r\n        }\r\n    },\r\n    {togglePersonal,selectedStaff}\r\n)\r\nclass Datagrid extends React.Component{\r\n    componentWillReceiveProps(np){\r\n        //console.log(np)\r\n    }\r\n    render(){\r\n        const emptyStyle={\r\n            height:`${this.props.tscale*70}vh`,\r\n            display:'flex',\r\n            alignItems:'center',\r\n            justifyContent:'center'\r\n        }\r\n        const empty=(\r\n            <div style={emptyStyle}>\r\n                <div>\r\n                    <img alt='' src={emptyIcon}/>\r\n                    <p>暂无数据</p>\r\n                </div>\r\n            </div>\r\n        )\r\n        const rowSelection={\r\n            //操作选中状态\r\n            selectedRowKeys:this.props.selectedStaffList.length>0?this.props.selectedStaffList.map(ss=>{\r\n                return ss.key\r\n            }):[],\r\n            onChange:(selectRowKeys,selectRows)=>{\r\n                //console.log(`selectRowKeys:${selectRowKeys}`,\"selectRows:\"+selectRows)\r\n            },\r\n            //record当前选中的行,selected是否选中,selectedRows所有被选中的数据\r\n            onSelect:(record,selected,selectedRows)=>{\r\n                this.props.selectedStaff(selectedRows)\r\n            },\r\n            onSelectAll:(isSlectedAll,selectedRows,changeRows)=>{\r\n                this.props.selectedStaff(selectedRows)\r\n            }\r\n        }\r\n        return(<Table rowSelection={this.props.calSelect?rowSelection:null} columns={this.props.tableHead} \r\n            onRow={(record) => {\r\n                return {\r\n                  onClick: () => {\r\n                      let ap=this.props.employeese.filter(e=>{\r\n                          return e.userId===record.key\r\n                      })\r\n                      //查看员工详情，插入当前选中的员工记录\r\n                      this.props.togglePersonal(ap[0])\r\n                  },\r\n                  onMouseEnter: () => {}\r\n                }\r\n            }}\r\n            size={this.props.tableSize?this.props.tableSize:'default'}\r\n            title={this.props.customHeader?this.props.customHeader:null}\r\n            locale={{emptyText: empty }} \r\n            pagination={false} rowClassName='table-row-name' className='column-name' \r\n            dataSource={this.props.sourceData} scroll={{ y: `${this.props.tscale*70}vh` }}></Table>)\r\n    }\r\n}\r\n\r\nexport default Datagrid","module.exports = __webpack_public_path__ + \"static/media/empty-icon.1e6b2481.svg\";","module.exports = __webpack_public_path__ + \"static/media/dept-icon-person.84461699.svg\";","module.exports = __webpack_public_path__ + \"static/media/edit-icon.509ac59a.svg\";","import React from 'react'\r\nimport './employee.scss'\r\n\r\n//企业管理者对应的部门列表\r\nimport deptIconPerson from 'static/images/dept-icon-person.svg'\r\nimport editIcon from 'static/images/edit-icon.svg'\r\n//import deleteIcon from 'static/images/delete-icon.svg'\r\nimport Datagrid from 'components/datagrid/datagrid'\r\nimport {Icon,Button,Input,Popover,Pagination,Avatar,Modal} from 'antd'\r\nimport {connect} from 'react-redux'\r\nimport {paginationTotal,getAvatar} from 'libs/common'\r\nimport {toggleModalState} from 'store/employeeModalReducer'\r\nimport {getStaffList} from 'store/staffReducer'\r\nimport {setCurrentDept} from 'store/deptReducer'\r\nimport Loadable from 'react-loadable'\r\nconst Personal = Loadable({loader: () => import('components/personal/personal'),loading() {return null}})\r\nconst DDModal = Loadable({loader: () => import('components/modals/ddmodal'),loading() {return null}})\r\nconst DSModal = Loadable({loader: () => import('components/modals/dsmodal'),loading() {return null}})\r\nconst SDDModal = Loadable({loader: () => import('components/modals/sddmodal'),loading() {return null}})\r\nconst UDNModal = Loadable({loader: () => import('components/modals/udnmodal'),loading() {return null}})\r\nconst ADDSModal = Loadable({loader: () => import('components/modals/addsmodal'),loading() {return null}})\r\n@connect(\r\n    state=>{\r\n        return{\r\n            //当前登录用户信息\r\n            loginUser:state.userReducer,\r\n            //已选择的用户列表\r\n            selectedStaffList:state.staffReducer.selectedStaffList,\r\n            //弹框状态\r\n            employeeModalState:state.employeeModalReducer,\r\n            //当前部门\r\n            currentDept:state.deptReducer.currentDept,\r\n            //用户列表数据（包括当前currentPage，total，object用户列表，）\r\n            employeese:state.staffReducer.staffData,\r\n            deptList:state.deptReducer.deptList,\r\n        }\r\n    },\r\n    {toggleModalState,getStaffList,setCurrentDept}\r\n)\r\nclass Employee extends React.Component{\r\n    constructor(props){\r\n        super(props)\r\n        this.state={\r\n            //表格缩放比例\r\n            tscale:1,\r\n            //请求相关参数\r\n            page:1,\r\n            limit:30,\r\n            searchName:'',\r\n            deptId:'',\r\n        }\r\n        this.getEmployees=this.getEmployees.bind(this)\r\n        this.deleteDept=this.deleteDept.bind(this)\r\n        this.setManager=this.setManager.bind(this)\r\n        this.staffDetail=this.staffDetail.bind(this)\r\n        this.delStaff=this.delStaff.bind(this)\r\n        this.updatedn=this.updatedn.bind(this)\r\n        this.searchHandler=this.searchHandler.bind(this)\r\n        this.emitEmptySearchName=this.emitEmptySearchName.bind(this)\r\n        this.addStaff=this.addStaff.bind(this)\r\n    }\r\n    componentWillMount(){\r\n        let ah=window.screen.availHeight\r\n        console.log(ah)\r\n        if(ah>900){\r\n            this.setState({scale:1})\r\n        }else if(ah<900&&ah>800){\r\n            this.setState({tscale:0.88})\r\n        }else if(ah<800&&ah>700){\r\n            this.setState({tscale:0.70})\r\n        }else{\r\n            this.setState({tscale:0.65})\r\n        }\r\n        if(this.props.currentDept){\r\n            this.getEmployees({deptId:this.props.currentDept.departmentId})\r\n        }\r\n    }\r\n    //object nextProps, object nextState\r\n    componentWillUpdate(np,ns){ } \r\n    //shouldComponentUpdate(){}\r\n    componentWillReceiveProps(np){\r\n        let tp=this.props\r\n        // console.log(tp)\r\n        // console.log(np)\r\n        //点击进入另一个部门\r\n        const anotherDept=tp.currentDept && np.currentDept　&& tp.currentDept.departmentId!==np.currentDept.departmentId\r\n        if(anotherDept){\r\n            this.getEmployees({deptId:np.currentDept.departmentId})\r\n        }\r\n        //部门管理员第一次进入管理后台，展开第一个部门\r\n        if(tp.loginUser.userRole!=='' && !tp.currentDept && np.currentDept){\r\n            //只有一个部门，自己是主管，自己把自己移除了\r\n            if(np.deptList && np.deptList.length>0){\r\n                tp.setCurrentDept(np.deptList[0])\r\n                this.getEmployees({deptId:np.deptList[0].departmentId})\r\n            }\r\n        }\r\n    }\r\n    updatedn(){\r\n        this.props.toggleModalState('UPDATE_DEPT_NAME',true)\r\n    }\r\n    //获取员工列表\r\n    getEmployees(obj){\r\n        let p={\r\n            page:this.state.page,\r\n            limit:this.state.limit,\r\n            searchName:this.state.searchName.trim(),\r\n            //当前部门ID\r\n            deptId:this.props.currentDept?this.props.currentDept.departmentId:0\r\n        }\r\n        let params=obj?Object.assign(p,obj):p\r\n        this.props.getStaffList(params)\r\n    }\r\n    //查询员工\r\n    searchHandler(){\r\n        if(this.state.searchName.trim()!==''){\r\n            this.getEmployees()\r\n        }\r\n    }\r\n    emitEmptySearchName(){\r\n        this.setState({searchName:''})\r\n        //setState是异步的，这里特殊处理下\r\n        this.getEmployees({searchName:''})\r\n    }\r\n    delStaff(e){\r\n        if(e.target.className==='del-staff-btn'){\r\n            this.props.toggleModalState('DEL_STAFF',true)\r\n        }\r\n    }\r\n    staffDetail(e){\r\n        //阻止冒泡的一种方式\r\n        if(e.target.className.indexOf('tr-content')>-1){\r\n            this.props.toggleModalState('STAFF_DETAIL',true)\r\n        }\r\n    }\r\n    addStaff(){\r\n        this.props.toggleModalState('ADD_STAFF',true)\r\n    }\r\n    deleteDept(){\r\n        //只能删除没有员工的部门（不合理，极其不合理）\r\n        if(this.props.currentDept.subEmployees>0){\r\n\r\n            Modal.confirm({\r\n                title: '无法删除',\r\n                centered:true,\r\n                content: '当部门没有任何员工时才可以删除部门',\r\n                okText:'确定',\r\n                cancelText:'取消',\r\n                onOk() {},\r\n                onCancel() {},\r\n            })\r\n        }else{\r\n            this.props.toggleModalState('DELETE_DEPT',true)\r\n        }\r\n    }\r\n    \r\n    setManager(){\r\n        this.props.toggleModalState('SET_DEPT_MANAGER',true)\r\n    }\r\n    render(){\r\n        const popoverContent=(\r\n            <div className=\"cp\">\r\n                <p>设为部门管理员</p>\r\n                <p>移除部门管理员</p>\r\n                <p>移交部门主管</p>\r\n                <p className=\"del-staff-btn\" onClick={this.delStaff}>移除员工</p>\r\n            </div>\r\n        )\r\n        const tHead=[{\r\n            title:\"员工\",\r\n            dataIndex:'name',\r\n            render:text=><div className=\"cp\">{text}</div>\r\n        },{\r\n            title:\"所在部门\",\r\n            dataIndex:'dept',\r\n        },{\r\n            title:\"手机号\",\r\n            dataIndex:'phone',\r\n        },{\r\n            title:\"邮箱\",\r\n            dataIndex:'email',\r\n        }]\r\n        let pageData=this.props.employeese.object && this.props.employeese.object.length!==0?this.props.employeese.object.map(employee=>{\r\n            let deptList=employee.departments.length>0?employee.departments.map((d,i)=>{\r\n                return i>0 ?`、${d.name}`:d.name\r\n            }):'待分配'\r\n            //dept manage boolean(是否是当前部门部门主管)\r\n            //business manage boolean(是否是当前企业管理员)\r\n            let  dmbool,bmbool\r\n            if(employee.userRoleInfos.length>0){\r\n                dmbool= employee.userRoleInfos.some((u)=>{\r\n                    return u.departmentId===this.props.currentDept.departmentId\r\n                })\r\n                bmbool= employee.userRoleInfos.some((u)=>{\r\n                    return u.roleName==='ENTERPRISE_MANAGER'\r\n                })\r\n            }\r\n            return {\r\n                key: employee.userId,\r\n                name: <div className=\"tr-content\" onClick={this.staffDetail}>\r\n                        <div>\r\n                            <Avatar src={getAvatar(employee.cloudUserId)}></Avatar>\r\n                            <span className=\"ml8\">{employee.name}</span>\r\n                            {/**显示角色（部门主管，企业管理员） */}\r\n                            {bmbool?<span  className=\"ml6 role-tip\">企业管理员</span>:null}\r\n                            {dmbool?<span  className=\"ml6 role-tip\">部门主管</span>:null}\r\n                        </div>\r\n                        {/**企业管理者不能操作？，就是这样 */}\r\n                        {this.props.loginUser.userRole===\"enterprise\"?null:<Popover placement=\"leftTop\" content={popoverContent}><Icon style={{display:'flex',alignItems:'center',fontSize: '20px'}} type=\"dash\" /></Popover>}\r\n                    </div>,\r\n                dept: <div className=\"ellipsis cp tr-content\" onClick={this.staffDetail} title={deptList}>{deptList}</div>,\r\n                phone: employee.mobile || '未绑定',\r\n                email: employee.email || '未绑定',\r\n            }\r\n        }):[]\r\n        \r\n        return(\r\n            <div className=\"dept-data-wrapper\">\r\n                <div className=\"toolbar\">\r\n                    <div className=\"dept-name-count\">\r\n                        <div className=\"icon-wrapper\">\r\n                            <img alt='' src={deptIconPerson}/>\r\n                        </div>\r\n                        <div className=\"name-count\">\r\n                            <h4 onClick={this.updatedn} className=\"name cp\">\r\n                                {this.props.currentDept?this.props.currentDept.name:'未定义'}\r\n                                <img className=\"ml4\" src={editIcon} alt=''/>\r\n                            </h4>\r\n                            <div>成员（{this.props.currentDept?this.props.currentDept.subEmployees:0}人）</div>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"operations\">\r\n                        <div className=\"oper-wrapper\">\r\n                            <Button onClick={this.addStaff}>添加员工</Button>\r\n                            <Button onClick={this.deleteDept}>删除部门</Button>\r\n                            <Button onClick={this.setManager}>指定部门主管</Button>\r\n                        </div>\r\n                        <div className=\"search-wrapper\">\r\n                            <Input prefix={<Icon type=\"search\"/>} placeholder='请输入关键字查询'\r\n                            suffix={this.state.searchName ? <Icon type=\"close-circle\" onClick={this.emitEmptySearchName} /> : null}\r\n                            onChange={e=>this.setState({searchName:e.target.value})}  value={this.state.searchName}\r\n                            onPressEnter={this.searchHandler}/>\r\n                            <Button onClick={this.searchHandler}>查询</Button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                {/* {this.props.selectedStaffList.length>0?<div className=\"batch-btns\">\r\n                    <Button onClick={this.delStaff} size=\"small\"><img src={deleteIcon} className=\"icon\" alt=''/>删除员工</Button>\r\n                </div>:null} */}\r\n                <div className=\"datagrid-wrapper dept-emp\">\r\n                    <Datagrid calSelect={false} tscale={this.state.tscale} tableHead={tHead} sourceData={pageData}/>\r\n                </div>\r\n                {this.props.employeese.total>0?<div className=\"pagenation-wrapper\">\r\n                    {/*自定义跳转到需要LocaleProvider，showQuickJumper*/}\r\n                    <Pagination\r\n                        defaultCurrent={this.props.employeese.currentPage} total={this.props.employeese.total} \r\n                        showTotal={()=>paginationTotal(this.props.employeese.total,this.props.employeese.currentPage)}\r\n                        onChange={this.pageChange} />\r\n                </div>:null}\r\n                {/**一些模态框 */}\r\n                {this.props.employeeModalState.deleteDeptModalVisible?<DDModal/>:null}\r\n                {this.props.employeeModalState.staffDetailModalVisible?<Personal/>:null}\r\n                {this.props.employeeModalState.addStaffModalVisible?<ADDSModal/>:null}\r\n                {/* 传入当前部门id */}\r\n                {this.props.employeeModalState.delStaffModalVisible?<DSModal />:null}\r\n                {this.props.employeeModalState.setDeptManagerModalVisible?<SDDModal/>:null}\r\n                {this.props.employeeModalState.updateDeptNameModalVisible?<UDNModal/>:null}\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default Employee"],"sourceRoot":""}
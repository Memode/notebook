(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{723:function(e,t,o){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0});var n=u(o(1)),r=o(109),l=o(85),s=o(83),i=u(o(84)),c=o(110),p=o(264);function u(e){return e&&e.__esModule?e:{default:e}}function m(e){return(m="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){for(var o=0;o<t.length;o++){var a=t[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}o(644);var g=n.default.createElement("div",{className:"radio-class tc"},"\u5f53\u524d\u90e8\u95e8\u5458\u5de5\u90fd\u662f\u90e8\u95e8\u4e3b\u7ba1"),E=n.default.createElement("div",{className:"tc"},"\u6682\u65e0\u8bb0\u5f55"),b=(0,s.connect)(function(e){return{loginUser:e.userReducer,mEmployee:e.staffReducer.mEmployee,currentDept:e.deptReducer.currentDept}},{toggleModalState:c.toggleModalState,getStaffList:p.getStaffList,getMEL:p.getMEL})(a=function(e){function t(e){var o,a,n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,(o=!(n=y(t).call(this,e))||"object"!==m(n)&&"function"!==typeof n?h(a):n).state={pointUserId:"",isAllocation:"",page:1,searchName:"",employeeArray:[],lastPage:!1,total:0,sortway:"\u5f53\u524d\u90e8\u95e8",sortWays:["\u5f53\u524d\u90e8\u95e8","\u6240\u6709\u5458\u5de5","\u672a\u5206\u914d"]},o.handleOk=o.handleOk.bind(h(h(o))),o.handleCancel=o.handleCancel.bind(h(h(o))),o.setManager=o.setManager.bind(h(h(o))),o.onChange=o.onChange.bind(h(h(o))),o.getMore=o.getMore.bind(h(h(o))),o.changgeSort=o.changgeSort.bind(h(h(o))),o}var o,a,s;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(t,n.default.Component),o=t,(a=[{key:"componentDidMount",value:function(){this.getEmployee({deptId:this.props.currentDept.departmentId})}},{key:"componentWillReceiveProps",value:function(e){var t=this.props;if(!t.mEmployee&&e.mEmployee&&e.mEmployee.object&&e.mEmployee.object.length>0){console.log("\u7b2c\u4e00\u6b21\u52a0\u8f7d\u6570\u636e");var o=this.state.employeeArray.concat(e.mEmployee.object);this.setState({employeeArray:o,page:e.mEmployee.currentPage,total:e.mEmployee.total,lastPage:o.length===e.mEmployee.total})}else if(t.mEmployee&&e.mEmployee&&e.mEmployee.object&&e.mEmployee.object.length>0){console.log("\u70b9\u51fb\u52a0\u8f7d\u66f4\u591a");var a=this.state.employeeArray.concat(e.mEmployee.object);this.setState({employeeArray:a,page:e.mEmployee.currentPage,total:e.mEmployee.total,lastPage:a.length===e.mEmployee.total})}else e.mEmployee&&0===e.mEmployee.total&&(console.log("\u52a0\u8f7d\u5b8c\u6240\u6709\u6570\u636e"),this.setState({employeeArray:[],page:1,total:0,lastPage:!0}))}},{key:"getEmployee",value:function(e){this.props.getMEL(e)}},{key:"getMore",value:function(){this.state.lastPage||"\u5f53\u524d\u90e8\u95e8"===this.state.sortway?this.state.lastPage||"\u5f53\u524d\u90e8\u95e8"!==this.state.sortway||this.getEmployee({page:this.state.page+1,isAllocation:this.state.isAllocation,deptId:this.props.currentDept.departmentId}):this.getEmployee({page:this.state.page+1,isAllocation:this.state.isAllocation})}},{key:"handleOk",value:function(){""!==this.state.pointUserId?this.setManager():r.message.error("\u8bf7\u5148\u8fdb\u5165\u8981\u64cd\u4f5c\u7684\u90e8\u95e8")}},{key:"changgeSort",value:function(e){"\u6240\u6709\u5458\u5de5"===e||"\u672a\u5206\u914d"===e?(this.setState({isAllocation:"\u6240\u6709\u5458\u5de5"===e?"":"\u672a\u5206\u914d"===e?"-1":"1"}),this.getEmployee({isAllocation:"\u6240\u6709\u5458\u5de5"===e?"":"-1"})):"\u5f53\u524d\u90e8\u95e8"===e&&(this.setState({isAllocation:""}),this.getEmployee({deptId:this.props.currentDept.departmentId})),this.setState({sortway:e,page:1,employeeArray:[],lastPage:!1})}},{key:"setManager",value:function(){var e=this,t={pointUserId:this.state.pointUserId,pointType:"1",deptId:this.props.currentDept.departmentId};i.default.put("enterprise/admin/setManager",t).then(function(t){t&&200===t.status&&(r.Modal.success({title:"\u7cfb\u7edf\u63d0\u793a",centered:!0,content:"\u64cd\u4f5c\u6210\u529f\uff01"}),e.props.toggleModalState("DEFAULT",!1),e.props.getStaffList({deptId:e.props.currentDept.departmentId}))})}},{key:"handleCancel",value:function(){this.props.toggleModalState("DEFAULT",!1)}},{key:"onChange",value:function(e){this.setState({pointUserId:e.target.value})}},{key:"render",value:function(){var e=this.props.currentDept.departmentId,t=this.state.employeeArray,o=t.filter(function(t){var o=t.departments,a=t.userRoleInfos;if(Object.assign(o,a).some(function(t){return t.departmentId===e&&t.roleName&&"DEPT_DIRECTOR"===t.roleName}))return t}).map(function(e){return e.userId}),a=t.length===o.length;return console.log(a),n.default.createElement(r.Modal,{width:300,visible:!0,title:"\u6307\u5b9a\u90e8\u95e8\u4e3b\u7ba1",centered:!0,onCancel:this.handleCancel,footer:[n.default.createElement(r.Button,{key:"1",onClick:this.handleCancel},"\u53d6\u6d88"),n.default.createElement(r.Button,{key:"2",type:"primary",onClick:this.handleOk},"\u786e\u8ba4")]},n.default.createElement("div",{className:"radio-wrapper"},n.default.createElement(r.Radio.Group,{style:{width:"100%"},onChange:this.onChange},this.state.employeeArray&&this.state.employeeArray.length>0?this.state.employeeArray.map(function(e){return o.some(function(t){return t===e.userId})?null:n.default.createElement("div",{className:"radio-class",key:e.userId},n.default.createElement(r.Radio,{value:e.userId},n.default.createElement(r.Avatar,{src:(0,l.getAvatar)(e.cloudUserId)}),n.default.createElement("span",{className:"ml6"},e.name)))}):null,t.length>0&&a?g:null),0===this.state.total?E:this.state.lastPage?null:n.default.createElement("div",{className:"cp theme-color tc",onClick:this.getMore},"\u52a0\u8f7d\u66f4\u591a")))}}])&&d(o.prototype,a),s&&d(o,s),t}())||a;t.default=b}}]);
//# sourceMappingURL=2.fa290ee4.chunk.js.map